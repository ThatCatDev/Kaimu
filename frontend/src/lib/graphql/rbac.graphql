# Queries

query Permissions {
  permissions {
    id
    code
    name
    description
    resourceType
  }
}

query Roles($organizationId: ID!) {
  roles(organizationId: $organizationId) {
    id
    name
    description
    isSystem
    scope
    createdAt
    updatedAt
    permissions {
      id
      code
      name
    }
  }
}

query Role($id: ID!) {
  role(id: $id) {
    id
    name
    description
    isSystem
    scope
    createdAt
    updatedAt
    permissions {
      id
      code
      name
      description
      resourceType
    }
  }
}

query OrganizationMembers($organizationId: ID!) {
  organizationMembers(organizationId: $organizationId) {
    id
    legacyRole
    createdAt
    user {
      id
      email
      displayName
    }
    role {
      id
      name
      description
      isSystem
    }
  }
}

query ProjectMembers($projectId: ID!) {
  projectMembers(projectId: $projectId) {
    id
    createdAt
    user {
      id
      email
      displayName
    }
    role {
      id
      name
      description
      isSystem
    }
    project {
      id
      name
    }
  }
}

query Invitations($organizationId: ID!) {
  invitations(organizationId: $organizationId) {
    id
    email
    expiresAt
    createdAt
    role {
      id
      name
    }
    invitedBy {
      id
      email
      displayName
    }
  }
}

query HasPermission($permission: String!, $resourceType: String!, $resourceId: ID!) {
  hasPermission(permission: $permission, resourceType: $resourceType, resourceId: $resourceId)
}

query MyPermissions($resourceType: String!, $resourceId: ID!) {
  myPermissions(resourceType: $resourceType, resourceId: $resourceId)
}

# Mutations

mutation CreateRole($input: CreateRoleInput!) {
  createRole(input: $input) {
    id
    name
    description
    isSystem
    scope
    createdAt
    updatedAt
    permissions {
      id
      code
      name
    }
  }
}

mutation UpdateRole($input: UpdateRoleInput!) {
  updateRole(input: $input) {
    id
    name
    description
    isSystem
    scope
    updatedAt
    permissions {
      id
      code
      name
    }
  }
}

mutation DeleteRole($id: ID!) {
  deleteRole(id: $id)
}

mutation InviteMember($input: InviteMemberInput!) {
  inviteMember(input: $input) {
    id
    email
    token
    expiresAt
    createdAt
    role {
      id
      name
    }
  }
}

mutation CancelInvitation($id: ID!) {
  cancelInvitation(id: $id)
}

mutation ResendInvitation($id: ID!) {
  resendInvitation(id: $id) {
    id
    email
    expiresAt
    createdAt
  }
}

mutation AcceptInvitation($token: String!) {
  acceptInvitation(token: $token) {
    id
    name
    slug
  }
}

mutation ChangeMemberRole($organizationId: ID!, $input: ChangeMemberRoleInput!) {
  changeMemberRole(organizationId: $organizationId, input: $input) {
    id
    legacyRole
    user {
      id
      email
      displayName
    }
    role {
      id
      name
    }
  }
}

mutation RemoveMember($organizationId: ID!, $userId: ID!) {
  removeMember(organizationId: $organizationId, userId: $userId)
}

mutation AssignProjectRole($input: AssignProjectRoleInput!) {
  assignProjectRole(input: $input) {
    id
    user {
      id
      email
      displayName
    }
    role {
      id
      name
    }
    project {
      id
      name
    }
  }
}

mutation RemoveProjectMember($projectId: ID!, $userId: ID!) {
  removeProjectMember(projectId: $projectId, userId: $userId)
}
